## Cumplimiento para componentes con tecnología web.

### Estrategia para controles de acceso

- Restricción de acceso para el uso de API´s (interfaz de programación de aplicaciones), del lado del servidor que atiende solicitudes para entrega de datos, metadatos y microdatos.
- El mecanismo de control de acceso permite la transferencia de datos para uso compartido de recursos entre orígenes (CORS – intercambios de recursos de origen cruzados).
- El control de acceso deberá tener la propiedad del registro, no aceptar que el usuario pueda crear, leer, actualizar o eliminar cualquier registro.
- En el servidor de aplicaciones con tecnología web deshabilitar la opción para visualizar la lista de directorios y asegúrese de que los datos, metadatos, microdatos, no estén presentes en la raíz de las carpetas.
- Registros de eventualidades en el control de acceso, considerando tener alertas a el grupo de administradores para el seguimiento.
- El acceso a las API´s deberá ser controlado por medio herramientas que permitan identificar ataques automatizados por bot´s maliciosos de orientadas a web como es el WAF (Web Application Firewall) [3].
- Los identificadores de sesión con estado “conexión” deben invalidarse en el servidor después de cerrar sesión. 
- Los tokens emitidos con JWT (Json Web Token) [4] deberán ser de corta duración, siguiendo los estándares de OAuth [5] para revocar el acceso.
- El grupo de seguridad informática deberá realizar pruebas funcionales para el control de calidad.
Estrategia para criptografía 
- Clasificar los datos procesados, almacenados o transferidos, identificando datos confidenciales de acuerdo con la norma de privacidad, los datos confidenciales innecesarios no son almacenados. 
- Utilizar tokenización compatible con PCI DSS (Payment Card Industry Data Security Standard) [6].
- Los datos confidenciales históricos serán almacenados en la bóveda digital de la plataforma transversal Institucional, que tienen implementados algoritmos, protocolos y claves estándar actualizados y sólidos.
- Los datos transferidos internos y externos serán cifrados y utilizar protocolos seguros como TLS (Transport Layer Security) [7], con directivas como HTTP Strict Transport Security (HSTS) [8].
- El almacenamiento en caché será deshabilitado para las respuestas que contienen datos confidenciales.
- No utilizar protocolos heredados como FTP (File Transfer Protocol) [9] y SMTP (Simple Mail Transfer Protocol) [10], para transferencia de datos confidenciales.
- Para el almacenamiento de contraseñas serán utilizadas funciones tipo hash adaptables (delay factor) con Argon2, scrypt, bcrypt o PBKDF2 [11].
- Utilizar CSPRNG (Cryptographically Secure PseudoRandom Number Generator) [12], generador de números pseudoaleatorios criptográficamente seguros, en el cifrado autenticado.
- Las claves deben generarse criptográficamente de forma aleatoria y almacenarse en la memoria como matrices de bytes, si se utiliza una contraseña, entonces deberá convertirse en una clave a través de una función.
- No utilizar funciones criptográficas obsoletas, como MD5, SHA1, PKCS número 1 v1.5 [13].

### Estrategia para Inyección de código 

- Implementar en la API´s el manejo de excepciones con una interfaz parametrizada por medio de ORM (Object Relational Mapping) [14], considerando la conexión a los manejadores de base de datos, (usuarios restringidos con base a roles), para la ejecución de los procedimientos almacenados basados en SQL, (PL/SQL y/o T-SQL) [15], utilizar “LImit”, y otros controles dentro de la concatenación de consultas planeadas conforme la lógica del negocio.

### Estrategia para diseño seguro 

- Establecer el ciclo de vida del componente (biblioteca de patrones de diseño), para los controles de seguridad y privacidad.
- Modelo de madurez para los procesos automatizados basados en ingeniería de componentes (Ciclo de vida) [2]

Gobernanza [Estrategia y métricas, Política y cumplimiento, Educación y orientación]
Diseño [Evaluación de amenazas, Requisitos de seguridad, Arquitectura de seguridad]
Implementación [Compilación segura, Implementación segura, Gestión de defectos]
Verificación [Evaluación de Arquitectura, Pruebas basadas en requisitos, Pruebas de seguridad]
Operaciones [Gestión de incidencias, Gestión del medio ambiente, Gestión Operativa]

### Estrategia en configuraciones para reducir eventualidades de seguridad

- Realizar periódicamente hardening a la infraestructura física y lógica donde están alojados los componentes en el entorno de pruebas, preproducción, producción, considerando los roles y perfiles para que las configuraciones estén con base a un estándar dentro del a la plataforma transversal.
- Revisión periódica de los servicios y microservicios que estén en arquitecturas monolíticas (hipervisores) o contenerización o seguridad en la nube ACL (Access Control List) [16].
- Proceso automatizado para verificar la efectividad de las configuraciones y ajustes en los entornos de pruebas, preproducción y producción considerando la base de datos de eventualidades Common Vulnerability and Exposures (CVE) [17] y National Vulnerability Database (NVD) [18].

### Estrategia para identificación y autenticación 

- Implemente la autenticación multifactor para evitar ataques de fuerza bruta y los ataques de reutilización de credenciales robadas.
- Verificar credenciales predeterminadas (contraseñas débiles), especialmente para usuarios administradores, así como también la rotación de contraseñas para usuarios de servicios transversales en tecnologías de información físicas y lógicas.
- El registro y la recuperación de credenciales en las rutas de las API´s, deberán estar reforzadas contra los ataques de enumeración, utilizar los mismos mensajes para todos los resultados.
- Limitar los intentos fallidos de inicio de sesión, cuidando en no crear un escenario de denegación de servicio, así como también registrar todos los errores, para que los administradores del servicio puedan reducir riesgos en la operación.
- Utilizar un administrador de sesiones para validar el tiempo inactivo para cerrar la sesión, generar un nuevo ID dentro de la URL.

### Estrategia para Integridad de datos en flujos de trabajo automatizados

- Implementar firmas digitales o mecanismos similares para verificar que los datos provienen de la fuente esperada y no han sido alterados.
- Verificar que los repositorios utilizados para intercambio de información cuenten con niveles de seguridad en los perfiles generados, dentro de la plataforma transversal Institucional, utilizar https://git.inegi.org.mx la cual tiene habilitado CI/CD (continuous Integration / continuous delivery) [19], para los flujos de trabajo basados en (pipeline).

### Estrategia para registro y supervisión de seguridad

- Todos los errores de inicio de sesión, control de acceso y validación de entrada del lado del servidor deberán ser registrados (con un formato estratégico), con suficiente contexto de usuario para identificar cuentas sospechosas o maliciosas y se conserven durante el tiempo suficiente para permitir un análisis forense.
- Las transferencias de datos por los canales definidos deberán tener una bitácora que permitirá realizar auditoria del proceso en caso de presentarse una eventualidad relacionada con la manipulación o eliminación. 
- Los equipos de trabajo DevSecOps (Developer Security Operation) [20], establecerán un monitoreo con base a alertas de actividades sospechosas que se detecten en tiempo de ejecución en la operación para responder de forma mediata, y no afectar el servicio.
- Adoptar el plan de respuesta y recuperación de incidentes referido en la Dirección de Seguridad Informática, adscrita a la Coordinación General de Informática dentro del Instituto.

### Estrategia para solicitudes al servidor con identidad falsa (SSRF)

- En la capa de red: segmentar la funcionalidad de acceso remoto a recursos en redes separadas para reducir el impacto de SSRF [21], aplicando directivas de directivas de firewall de "denegar de forma predeterminada" o reglas de control de acceso a la red para bloquear todo el tráfico de intranet excepto el esencial, revisar el ciclo de vida para las reglas determinadas.
- En la capa de aplicación: validar los datos de entrada suministrados por el cliente, verificar el puerto origen – destino de la url, no enviar respuestas sin procesar al cliente, deshabilitar las redirecciones por medio del protocolo http habilitado en el DNS registrado, para el front-end que requieran tener acceso a servicios internos utilizar VPN (Virtual Private Network) [22].

